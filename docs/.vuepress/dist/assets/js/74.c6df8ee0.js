(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{440:function(t,a,s){"use strict";s.r(a);var e=s(45),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"webpack的热更新是如何做到的-原理是什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack的热更新是如何做到的-原理是什么"}},[t._v("#")]),t._v(" webpack的热更新是如何做到的？原理是什么？")]),t._v(" "),s("h3",{attrs:{id:"一、是什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、是什么"}},[t._v("#")]),t._v(" 一、是什么")]),t._v(" "),s("p",[s("code",[t._v("HMR")]),t._v("全称 "),s("code",[t._v("Hot Module Replacement")]),t._v("，可以理解为模块热替换，指在应用程序运行过程中，替换、添加、删除模块，而无需重新刷新整个应用")]),t._v(" "),s("p",[t._v("例如，我们在应用运行过程中修改了某个模块，通过自动刷新会导致整个应用的整体刷新，那页面中的状态信息都会丢失")]),t._v(" "),s("p",[t._v("如果使用的是 "),s("code",[t._v("HMR")]),t._v("，就可以实现只将修改的模块实时替换至应用中，不必完全刷新整个应用")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("webpack")]),t._v("中配置开启热模块也非常的简单，如下代码：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" webpack "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'webpack'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  devServer"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开启 HMR 特性")]),t._v("\n    hot"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hotOnly: true")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("通过上述这种配置，如果我们修改并保存"),s("code",[t._v("css")]),t._v("文件，确实能够以不刷新的形式更新到页面中")]),t._v(" "),s("p",[t._v("但是，当我们修改并保存"),s("code",[t._v("js")]),t._v("文件之后，页面依旧自动刷新了，这里并没有触发热模块")]),t._v(" "),s("p",[t._v("所以，"),s("code",[t._v("HMR")]),t._v("并不像 "),s("code",[t._v("Webpack")]),t._v(" 的其他特性一样可以开箱即用，需要有一些额外的操作")]),t._v(" "),s("p",[t._v("我们需要去指定哪些模块发生更新时进行"),s("code",[t._v("HRM")]),t._v("，如下代码：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("accept")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./util.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"util.js更新了"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"二、实现原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、实现原理"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://vue3js.cn/interview/webpack/HMR.html#%E4%BA%8C%E3%80%81%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86",target:"_blank",rel:"noopener noreferrer"}},[t._v("#"),s("OutboundLink")],1),t._v("二、实现原理")]),t._v(" "),s("p",[t._v("首先来看看一张图，如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://tts-markdown.oss-cn-beijing.aliyuncs.com/img/adc05780-acd4-11eb-ab90-d9ae814b240d.png",alt:"img"}})]),t._v(" "),s("ul",[s("li",[t._v("Webpack Compile：将 JS 源代码编译成 bundle.js")]),t._v(" "),s("li",[t._v("HMR Server：用来将热更新的文件输出给 HMR Runtime")]),t._v(" "),s("li",[t._v("Bundle Server：静态资源文件服务器，提供文件访问路径")]),t._v(" "),s("li",[t._v("HMR Runtime：socket服务器，会被注入到浏览器，更新文件的变化")]),t._v(" "),s("li",[t._v("bundle.js：构建输出的文件")]),t._v(" "),s("li",[t._v("在HMR Runtime 和 HMR Server之间建立 websocket，即图上4号线，用于实时更新文件变化")])]),t._v(" "),s("p",[t._v("上面图中，可以分成两个阶段：")]),t._v(" "),s("ul",[s("li",[t._v("启动阶段为上图 1 - 2 - A - B")])]),t._v(" "),s("p",[t._v("在编写未经过"),s("code",[t._v("webpack")]),t._v("打包的源代码后，"),s("code",[t._v("Webpack Compile")]),t._v(" 将源代码和 "),s("code",[t._v("HMR Runtime")]),t._v(" 一起编译成 "),s("code",[t._v("bundle")]),t._v("文件，传输给"),s("code",[t._v("Bundle Server")]),t._v(" 静态资源服务器")]),t._v(" "),s("ul",[s("li",[t._v("更新阶段为上图 1 - 2 - 3 - 4")])]),t._v(" "),s("p",[t._v("当某一个文件或者模块发生变化时，"),s("code",[t._v("webpack")]),t._v("监听到文件变化对文件重新编译打包，编译生成唯一的"),s("code",[t._v("hash")]),t._v("值，这个"),s("code",[t._v("hash")]),t._v("值用来作为下一次热更新的标识")]),t._v(" "),s("p",[t._v("根据变化的内容生成两个补丁文件："),s("code",[t._v("manifest")]),t._v("（包含了 "),s("code",[t._v("hash")]),t._v(" 和 "),s("code",[t._v("chundId")]),t._v("，用来说明变化的内容）和"),s("code",[t._v("chunk.js")]),t._v(" 模块")]),t._v(" "),s("p",[t._v("由于"),s("code",[t._v("socket")]),t._v("服务器在"),s("code",[t._v("HMR Runtime")]),t._v(" 和 "),s("code",[t._v("HMR Server")]),t._v("之间建立 "),s("code",[t._v("websocket")]),t._v("链接，当文件发生改动的时候，服务端会向浏览器推送一条消息，消息包含文件改动后生成的"),s("code",[t._v("hash")]),t._v("值，如下图的"),s("code",[t._v("h")]),t._v("属性，作为下一次热更细的标识")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://tts-markdown.oss-cn-beijing.aliyuncs.com/img/05a0edf0-ad4a-11eb-85f6-6fac77c0c9b3.png",alt:"img"}})]),t._v(" "),s("p",[t._v("在浏览器接受到这条消息之前，浏览器已经在上一次"),s("code",[t._v("socket")]),t._v(" 消息中已经记住了此时的"),s("code",[t._v("hash")]),t._v(" 标识，这时候我们会创建一个 "),s("code",[t._v("ajax")]),t._v(" 去服务端请求获取到变化内容的 "),s("code",[t._v("manifest")]),t._v(" 文件")]),t._v(" "),s("p",[s("code",[t._v("mainfest")]),t._v("文件包含重新"),s("code",[t._v("build")]),t._v("生成的"),s("code",[t._v("hash")]),t._v("值，以及变化的模块，对应上图的"),s("code",[t._v("c")]),t._v("属性")]),t._v(" "),s("p",[t._v("浏览器根据 "),s("code",[t._v("manifest")]),t._v(" 文件获取模块变化的内容，从而触发"),s("code",[t._v("render")]),t._v("流程，实现局部模块更新")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://tts-markdown.oss-cn-beijing.aliyuncs.com/img/0e7b7850-ad4a-11eb-ab90-d9ae814b240d.png",alt:"img"}})]),t._v(" "),s("h2",{attrs:{id:"三、总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、总结"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://vue3js.cn/interview/webpack/HMR.html#%E4%B8%89%E3%80%81%E6%80%BB%E7%BB%93",target:"_blank",rel:"noopener noreferrer"}},[t._v("#"),s("OutboundLink")],1),t._v("三、总结")]),t._v(" "),s("p",[t._v("关于"),s("code",[t._v("webpack")]),t._v("热模块更新的总结如下：")]),t._v(" "),s("ul",[s("li",[t._v("通过"),s("code",[t._v("webpack-dev-server")]),t._v("创建两个服务器：提供静态资源的服务（express）和Socket服务")]),t._v(" "),s("li",[t._v("express server 负责直接提供静态资源的服务（打包后的资源直接被浏览器请求和解析）")]),t._v(" "),s("li",[t._v("socket server 是一个 websocket 的长连接，双方可以通信")]),t._v(" "),s("li",[t._v("当 socket server 监听到对应的模块发生变化时，会生成两个文件.json（manifest文件）和.js文件（update chunk）")]),t._v(" "),s("li",[t._v("通过长连接，socket server 可以直接将这两个文件主动发送给客户端（浏览器）")]),t._v(" "),s("li",[t._v("浏览器拿到两个新的文件后，通过HMR runtime机制，加载这两个文件，并且针对修改的模块进行更新")])]),t._v(" "),s("h1",{attrs:{id:"一分钟用上热更新-react-fast-refresh-react-refresh"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一分钟用上热更新-react-fast-refresh-react-refresh"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://segmentfault.com/a/1190000023534941",target:"_blank",rel:"noopener noreferrer"}},[t._v("一分钟用上热更新 React Fast Refresh（react-refresh）"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("官方实现为 "),s("code",[t._v("react-refresh")])]),t._v(" "),s("h2",{attrs:{id:"快速上手"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速上手"}},[t._v("#")]),t._v(" 快速上手")]),t._v(" "),s("p",[t._v("不浪费时间，请跟着我在 "),s("strong",[t._v("1分钟")]),t._v(" 内构建一个支持 React Fast Refresh 的应用。")]),t._v(" "),s("h3",{attrs:{id:"安装依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[t._v("#")]),t._v(" 安装依赖")]),t._v(" "),s("p",[t._v("主要使用下面两个 npm 包（"),s("em",[t._v("可以跳过，直接拷贝下文的 "),s("code",[t._v("package.json")])]),t._v("）")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" @pmmmwh/react-refresh-webpack-plugin react-refresh\n")])])]),s("h3",{attrs:{id:"webpack-config-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack-config-js"}},[t._v("#")]),t._v(" "),s("code",[t._v("webpack.config.js")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ReactRefreshPlugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@pmmmwh/react-refresh-webpack-plugin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" HtmlWebpackPlugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'html-webpack-plugin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./index.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  module"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    rules"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        test"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.js$")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        exclude"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("node_modules")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        loader"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'babel-loader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        options"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          presets"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@babel/env'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@babel/preset-react'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("require"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react-refresh/babel'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 为 react-refresh 添加")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReactRefreshPlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 为 react-refresh 添加")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HtmlWebpackPlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      template"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./index.html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"最后"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最后"}},[t._v("#")]),t._v(" 最后")]),t._v(" "),s("p",[t._v("安装 "),s("code",[t._v("npm install")])]),t._v(" "),s("p",[t._v("启动 "),s("code",[t._v("npm run start")])]),t._v(" "),s("p",[t._v("你肯定已经顺利跑起来了")]),t._v(" "),s("p",[t._v("那尝试修改 "),s("code",[t._v("App.js")]),t._v(" 看看吧！")]),t._v(" "),s("h2",{attrs:{id:"与-react-hot-loader-相比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#与-react-hot-loader-相比"}},[t._v("#")]),t._v(" 与 "),s("code",[t._v("react-hot-loader")]),t._v(" 相比")]),t._v(" "),s("p",[t._v("使用过 HMR 的同学，想必都有接触 "),s("code",[t._v("react-hot-loader")]),t._v(" 可能会说，我现在用的好好的，为什么要换，这不是没事找事闲扯淡嘛？")]),t._v(" "),s("p",[t._v("原因以下几点")]),t._v(" "),s("h3",{attrs:{id:"_1-官方支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-官方支持"}},[t._v("#")]),t._v(" 1. 官方支持")]),t._v(" "),s("p",[t._v("官方的支持，除了光环之外，还带来性能与稳定性保障，对 hook 更完善的支持...")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://link.segmentfault.com/?enc=qCDC1XyZe4Vbt4mVMmeOFQ%3D%3D.YQ2nPGowlYO9fJIjQBiel34MWZW3aSlhu3fN92gtZtAN%2FycIQVT3AYy1PjiX2MSVg8m5pSu%2FqKUYryXpXYEMbqa7ZiXxAiCGuHo1rbA9%2BgQ%3D",target:"_blank",rel:"noopener noreferrer"}},[t._v("How should we set up apps for HMR now that Fast Refresh replaces react-hot-loader?（官方给出的简要使用教程）"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"_2-更低的侵入性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-更低的侵入性"}},[t._v("#")]),t._v(" 2. 更低的侵入性")]),t._v(" "),s("p",[t._v("不必在项目代码中用 "),s("code",[t._v("hot(App)")]),t._v(" 的形式来标记组件，或是在 "),s("code",[t._v("webpack.entry")]),t._v(" 中注入额外代码")]),t._v(" "),s("h3",{attrs:{id:"_3-react-hot-loader-官方退役声明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-react-hot-loader-官方退役声明"}},[t._v("#")]),t._v(" 3. react-hot-loader 官方退役声明")]),t._v(" "),s("p",[t._v("引用官方声明")]),t._v(" "),s("p",[s("strong",[t._v("React-Hot-Loader is expected to be replaced by "),s("a",{attrs:{href:"https://link.segmentfault.com/?enc=jabTsw0muJUV6t3tFaD2ow%3D%3D.C%2BBQpo4%2F0Yhfin7967byfeUyyJTa1bskqIr8AN78Jvi8l1KAp4t2Q1mtDyvOKd8i",target:"_blank",rel:"noopener noreferrer"}},[t._v("React Fast Refresh"),s("OutboundLink")],1)]),t._v(". Please remove React-Hot-Loader if Fast Refresh is currently supported on your environment.")]),t._v(" "),s("blockquote",[s("p",[t._v("翻译："),s("strong",[t._v("预计 React-Hot-Loader 将被 "),s("a",{attrs:{href:"https://link.segmentfault.com/?enc=AFkTK0WUyVUaA%2BD7o3Lp6A%3D%3D.Hb0PT5iN3wDEvfrefUteDLjuMrlUxJ6CanYTi%2BaseE34XDTwYIT4pyv3GnsykM1D",target:"_blank",rel:"noopener noreferrer"}},[t._v("React快速刷新 "),s("OutboundLink")],1),t._v("取代")]),t._v("。如果您的环境支持 Fast Refresh，那么请删除 React-Hot-Loader。")])]),t._v(" "),s("h2",{attrs:{id:"注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),s("ul",[s("li",[t._v("react-refresh 最低支持版本 "),s("code",[t._v("react-dom@16.9+")]),t._v("，如果添加到老项目中后，热更新没有生效，那么首先请确认版本是否满足要求。")]),t._v(" "),s("li",[t._v("入口文件不支持 HMR，如果在入口文件中直接修改组件，会降级为 LiveReload。")]),t._v(" "),s("li",[t._v("webpack 的 "),s("code",[t._v("externals")]),t._v(" 配置项会导致 "),s("code",[t._v("react-refresh")]),t._v(" 失效，在 "),s("code",[t._v("dev")]),t._v("环境下可以先关闭配置。")])])])}),[],!1,null,null,null);a.default=n.exports}}]);